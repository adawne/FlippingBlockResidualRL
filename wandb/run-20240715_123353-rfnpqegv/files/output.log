Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Epoch #1: 1001it [00:00, 1215.22it/s, env_step=1000, gradient_step=100, len=0, n/ep=0, n/st=1000, rew=0.00]
Epoch #2:   0%|                                                                                                                                                                           | 0/1000 [00:00<?, ?it/s]

Epoch #2: 1001it [00:00, 1562.41it/s, env_step=2000, gradient_step=200, len=0, n/ep=0, n/st=1000, rew=0.00]
Epoch #3:   0%|                                                                                                                                                                           | 0/1000 [00:00<?, ?it/s]
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.
Block not flipped or rotated.

Epoch #3: 1001it [00:00, 1575.01it/s, env_step=3000, gradient_step=300, len=0, n/ep=0, n/st=1000, rew=0.00]
Traceback (most recent call last):
  File "/home/ubuntu/code/UR10FlippingBlockRL/train_dqn.py", line 152, in <module>
    train_dqn()
  File "/home/ubuntu/code/UR10FlippingBlockRL/train_dqn.py", line 139, in train_dqn
    ).run()
      ^^^^^
  File "/home/ubuntu/miniconda3/envs/RL_env/lib/python3.11/site-packages/tianshou/trainer/base.py", line 526, in run
    deque(self, maxlen=0)  # feed the entire iterator into a zero-length deque
    ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/RL_env/lib/python3.11/site-packages/tianshou/trainer/base.py", line 359, in __next__
    test_stat, self.stop_fn_flag = self.test_step()
                                   ^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/RL_env/lib/python3.11/site-packages/tianshou/trainer/base.py", line 389, in test_step
    test_stat = test_episode(
                ^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/RL_env/lib/python3.11/site-packages/tianshou/trainer/utils.py", line 34, in test_episode
    result = collector.collect(n_episode=n_episode)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/RL_env/lib/python3.11/site-packages/tianshou/data/collector.py", line 364, in collect
    self._reset_env_with_ids(env_ind_local, env_ind_global, gym_reset_kwargs)
  File "/home/ubuntu/miniconda3/envs/RL_env/lib/python3.11/site-packages/tianshou/data/collector.py", line 209, in _reset_env_with_ids
    obs_reset, info = self.env.reset(global_ids, **gym_reset_kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/RL_env/lib/python3.11/site-packages/tianshou/env/venvs.py", line 211, in reset
    self.workers[i].send(None, **kwargs)
  File "/home/ubuntu/miniconda3/envs/RL_env/lib/python3.11/site-packages/tianshou/env/worker/dummy.py", line 39, in send
    self.result = self.env.reset(**kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/RL_env/lib/python3.11/site-packages/gymnasium/core.py", line 414, in reset
    return self.env.reset(seed=seed, options=options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/RL_env/lib/python3.11/site-packages/gymnasium/wrappers/order_enforcing.py", line 61, in reset
    return self.env.reset(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/miniconda3/envs/RL_env/lib/python3.11/site-packages/gymnasium/wrappers/env_checker.py", line 57, in reset
    return self.env.reset(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/code/UR10FlippingBlockRL/research_main/envs/FlippingEnv.py", line 95, in reset
    self.fsm.state = self.fsm.reset_pose(self.model, self.data, current_position)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/code/UR10FlippingBlockRL/research_main/envs/finite_state_machine.py", line 98, in reset_pose
    move_ee_to_point(model, data, self.target_position, self.target_orientation)
  File "/home/ubuntu/code/UR10FlippingBlockRL/research_main/envs/utils.py", line 41, in move_ee_to_point
    joint_angles_target = diffik(model, data, target_position, target_orientation)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/code/UR10FlippingBlockRL/research_main/envs/utils.py", line 131, in diffik
    body_ids = [model.body(name).id for name in body_names]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/code/UR10FlippingBlockRL/research_main/envs/utils.py", line 131, in <listcomp>
    body_ids = [model.body(name).id for name in body_names]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt